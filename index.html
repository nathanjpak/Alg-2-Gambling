<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mr. Pak's Deals</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="header">
    Your money: 
    <div id="money">
    </div>
  </div>
  <div id="container">

  </div>
  
  <script>
    // Your JavaScript goes here!
    //console.log("Hello, World!")

    //declarations
    let money = 50;
    let moneyDiv = document.getElementById("money");
    let skipCount = 0;

    let container = document.getElementById("container");
    let choices = document.createElement("div");

    const maxValue = (5+10+5+12+10);
    const dealFiveChoices = ["rock", "paper", "scissors"];

    //onload
    function onLoad() {
      updateMoney();
      loadOne();
    }



    //Loading Functions

    

    function loadOne() {
      let header = document.createElement("div");
      header.classList.add("dealHeader");
      header.textContent = "Deal One: Heads or Tails?";
      let description = document.createElement("p");
      description.classList.add("dealDescription");
      description.textContent = `Let's say we flip a coin.\nIf it's heads, you win $5.\nIf it's tails, you lose $7.`
      container.appendChild(header);
      container.appendChild(description);
      createButton("Flip Coin", dealOne);
      createSkip(loadTwo);

      container.appendChild(choices);
    }

    function loadTwo() {
      clearContainer();
      let header = document.createElement("div");
      header.classList.add("dealHeader");
      header.textContent = "Deal Two: 6-Sided Die";
      let description = document.createElement("p");
      description.classList.add("dealDescription");
      description.textContent = "Let's say we roll a 6-sided die.\nIf the result is 1 or 2, you win $10. If it's anything else, you lose $3.";
      container.appendChild(header);
      container.appendChild(description);
      //buttons
      createButton("Roll the Die?", dealTwo);
      createSkip(loadThree);

      container.appendChild(choices);
    }

    function loadThree() {
      clearContainer();
      let header = document.createElement("div");
      header.classList.add("dealHeader");
      header.textContent = "Deal Three: Free Throw";
      let description = document.createElement("p");
      description.classList.add("dealDescription");
      description.textContent = "Jordan Poole is about to shoot a free throw.\nThis year, he's made 92.5% of his free throws.\nIf he makes it, you get $5.\nIf he misses, you lose $60.";
      container.appendChild(header);
      container.appendChild(description);
      //buttons
      createButton("Buckets!", dealThree);
      createSkip(loadFour);
            
      container.appendChild(choices);
    }

    function loadFour() {
      clearContainer();
      let header = document.createElement("div");
      header.classList.add("dealHeader");
      header.textContent = "Deal Four: Another Die";
      let description = document.createElement("p");
      description.classList.add("dealDescription");
      description.textContent = "Let's say we roll a 6-sided die again.\nThis time, if the result is a 1 or 2, you win $12.\n If the result is 3, 4, or 5, you lose $2.\n. If the result is a 6, you lose $50.";
      container.appendChild(header);
      container.appendChild(description);
      //buttons
      createButton("Roll the Die!", dealFour);
      createSkip(loadFive);
      
      container.appendChild(choices);
    }

    function loadFive() {
      clearContainer();
      let header = document.createElement("div");
      header.classList.add("dealHeader");
      header.textContent = "Deal Five: Rock-Paper-Scissors";
      let description = document.createElement("p");
      description.classList.add("dealDescription");
      description.textContent = "Let's play rock-paper-scissors.\nIf you win, you win $10.\nIf you lose, you lose $5.\nIf we tie, you lose $1.";
      container.appendChild(header);
      container.appendChild(description);
      //buttons
      createButton("Rock", dealFive, "rock");
      createButton("Paper", dealFive, "paper");
      createButton("Scissors", dealFive, "scissors");
      createSkip(loadSix);
      
      container.appendChild(choices);
    }

    function loadSix() {
      clearContainer();
      let header = document.createElement("div");
      header.classList.add("dealHeader");
      header.textContent = "Deal Six: Free Throws - Evil Steph Curry Edition";
      let description = document.createElement("p");
      description.classList.add("dealDescription");
      description.textContent = "You're watching free throws again, but Stephen Curry is at the line (Career: 90.7%).\nStephen Curry documentedly hates charity, so if he makes it you lose $15.\nBut if he misses, you win $75!";
      container.appendChild(header);
      container.appendChild(description);
      //buttons
      createButton("Clank!", dealSix);
      createSkip(checkFinalSkip);
      
      container.appendChild(choices);
    }

    //common buttons
    function createSkip(function_parameter) {
      let button = document.createElement("button");
      button.textContent = "Skip This Deal";
      button.onclick = () => {skipCount++; function_parameter()};
      choices.appendChild(button);
    }

    function createButton(text, func, function_parameter="") {
      let button = document.createElement("button");
      button.textContent = text;
      button.onclick = () => func(function_parameter);
      choices.appendChild(button);
    }

    //Deal 1
    function dealOne() {
      let coin; 
      coin = Math.random();
      console.log(coin);
      (coin >= 0.5) ? winOne() : loseOne();
    }

    function winOne() {
      console.log("You won!");
      money += 5;
      updateMoney();
      alert(`Heads! You won $5.`);
      loadTwo();
    }

    function loseOne() {
      console.log("You lost!");
      money -= 7;
      updateMoney();
      alert(`Tails! You lost $7.`);
      loadTwo();
    }

    //Deal 2
    function dealTwo() {
      let dice; 
      dice = getRandomInt(6)+1;
      console.log(dice);
      (dice < 3) ? winTwo(dice) : loseTwo(dice);
    }

    function winTwo(num) {
      console.log(`You won! You rolled a ${num}`);
      money += 10;
      updateMoney();
      alert(`You rolled a ${num}! You won $10.`);
      loadThree();
    }

    function loseTwo(num) {
      console.log(`You lost! You rolled a ${num}`)
      money -= 3;
      updateMoney();
      alert(`You rolled a ${num}! You lost $3.`)
      loadThree();
    }

    //Deal 3
    function dealThree() {
      let freeThrow
      freeThrow = Math.random();
      console.log(freeThrow);
      (freeThrow < 0.925) ? winThree() : loseThree();
    }

    function winThree() {
      console.log("He made it!");
      money += 5;
      updateMoney();
      alert("He made it! You won $5.");
      loadFour();
    }

    function loseThree() {
      console.log("He missed!");
      money -= 60;
      updateMoney();
      alert("Oh no! He missed! You lost $60.");
      loadFour();
    }

    //Deal 4
    function dealFour() {
      let dice
      dice = getRandomInt(6)+1;
      console.log(dice);
      switch(dice) {
        case 1:
        case 2: 
          winFour(dice);
          break;
        case 6:
          loseFourBadly();
          break;
        default:
          loseFour(dice);
      }
    }

    function winFour(num) {
      console.log(`You won! You rolled a ${num}`);
      money += 12;
      updateMoney();
      alert(`You rolled a ${num}! You won $12.`);
      loadFive();
    }

    function loseFour(num) {
      console.log(`You lost! You rolled a ${num}`)
      money -= 2;
      updateMoney();
      alert(`You rolled a ${num}! You lost $2.`)
      loadFive();
    }

    function loseFourBadly() {
      console.log("Oh no! You rolled a 6!");
      money -= 50;
      updateMoney();
      alert(`Oh no! You rolled a 6! You lost $50.`)
      loadFive();
    }

    //Deal 5
    function dealFive(choice) {
      let hand;
      let x;
      x = getRandomInt(3);
      hand = dealFiveChoices[x];
      console.log(hand);
      (hand == choice) ? dealFiveTie(hand) : checkRockPaperScissors(choice, hand);
    }

    function dealFiveWin(comp) {
      console.log(`You won! The opponent chose ${comp}`)
      money += 10;
      updateMoney();
      alert(`You won! The opponent chose ${comp}. \nYou won $10.`);
      loadSix();
    }

    function dealFiveLose(comp) {
      console.log(`You lost! The opponent chose ${comp}`);
      money -= 5;
      updateMoney();
      alert(`You lost! The opponent chose ${comp}. \nYou lost $5.`);
      loadSix();
    }

    function dealFiveTie(comp) {
      console.log(`You tied! The opponent chose ${comp}`);
      money -= 1;
      updateMoney();
      alert(`You tied! The opponent chose ${comp}. \nYou lost $1.`)
      loadSix();
    }

    function dealSix() {
      let freeThrow
      freeThrow = Math.random();
      console.log(freeThrow);
      (freeThrow < 0.907) ? loseSix() : winSix();
    }

    function winSix() {
      money += 75;
      updateMoney();
      alert(`He missed!\nYou won $75!`);
      finish();
    }

    function loseSix() {
      money -= 15;
      updateMoney();
      alert(`He made it.\nYou lost $15.`);
      finish();
    }

    function finish() {
      let profit = (money - 50);
      if (profit < -50) {
        if (confirm(`You made -$${-profit} and some terrible life decisions.\nStart over?`)) {
          window.location.reload();
        }
        else {
          alert("Oh. Ok.");
          clearContainer();
        }
      } else if (profit < 0) {
        if (confirm(`You made -$${-profit}, but I think you could do better.\nStart over?`)) {
          window.location.reload();
        }
        else {
          alert("Oh. Ok.");
          clearContainer();
        }
      } else if (profit == 0) {
        if (confirm(`You made $0.\nStart over?`)) {
          window.location.reload();
        }
        else {
          alert("Oh. Ok.");
          clearContainer();
        } 
      } else if (profit < maxValue) {
        if (confirm(`You made $${profit}. Great job!\nStart over?`)) {
          window.location.reload();
        }
        else {
          alert("Oh. Ok.");
          clearContainer();
        }
      } else {
        if (confirm(`Wow, you made $${profit}! You're certainly a lucky person.\nStart over?`)) {
          window.location.reload();
        }
        else {
          alert("Understandable. It's quite the achievement.");
          clearContainer();
        }
      }      
    }

    function checkRockPaperScissors(player, comp) {
      if (player == "rock") {
        (comp == "scissors") ? dealFiveWin(comp) : dealFiveLose(comp);
      }
      else if (player == "scissors") {
        (comp == "paper") ? dealFiveWin(comp) : dealFiveLose(comp);
      }
      else {
        (comp == "rock") ? dealFiveWin(comp) : dealFiveLose(comp);
      }
    }

    //misc functions

    function checkFinalSkip() {
      (skipCount > 4) ? alert("You can't skip them all!") : finish();
    }

    function updateMoney() {
      (money < 0) ? moneyDiv.textContent= `-$${-money}` : moneyDiv.textContent =` $${money}`;
    }

    function clearContainer() {
      while (container.firstChild) {
        container.removeChild(container.firstChild);
      }
      while (choices.firstChild) {
        choices.removeChild(choices.firstChild);
      }
    }
    
    function getRandomInt(max) {
      return Math.floor(Math.random() * max);
    }

    onLoad();

  </script>
</body>
</html>